% Copyright © 2013, Gray Calhoun.  Permission is granted to copy,
% distribute and/or modify this document under the terms of the GNU
% Free Documentation License, Version 1.3 or any later version
% published by the Free Software Foundation; with no Invariant
% Sections, no Front-Cover Texts, and no Back-Cover Texts.  A copy of
% the license is included in the section entitled "GNU Free
% Documentation License."

\chapter{Interval estimators}

\begin{itemize}
\item Covered on
\begin{itemize}
\item \textit{2009-10-05 Mon}
\item \textit{2010-10-05 Tue}
\item \textit{2011-09-29 Thu}, \textit{2011-10-04 Tue}
\end{itemize}
\item Reading
\begin{itemize}
\item CB 9.1-9.3
\item Greene C.6
\end{itemize}
\end{itemize}
\section{Intro}
\label{sec-1}

\begin{itemize}
\item We can take the ``hypothesis testing mentality'' and apply it to
      point estimation
\begin{itemize}
\item apply the philosophy of hypothesis testing
\item apply the mathematics of hypothesis testing
\end{itemize}
\item point estimation
\begin{itemize}
\item want to get a value
\begin{itemize}
\item have an unknown parameter $\theta$
\item use that data to construct a best guess for $\theta$
\item we're going to use that value as though it were true
\end{itemize}
\end{itemize}
\item confidence intervals
\begin{itemize}
\item want to get a range of values that are \emph{possible}
\item we're going to consider those that are inside the interval
        indistinguishable from eachother and those outside
        indistinguishable from eachother too.
\end{itemize}
\end{itemize}
\section{Definitions}
\label{sec-2}

\begin{itemize}
\item An \emph{interval estimator} of a parameter $\theta$ is any pair of
      functions $L(X)$ and $U(X)$ s.t. $L(x) \leq U(x)$ for all $x$
      and, when we observe $x$ we make the inference $\theta \in
      [L(x), U(x)]$
\item The \emph{coverage probability} of an interval estimator
      $[L(X),U(X)]$ is the probability $P_\theta[\theta \in [L(X), U(X)]]$
\item The \emph{confidence coefficient} is $\inf_\theta P_\theta[\theta \in [L(X), U(X)]]$
\end{itemize}
\section{Relationship to hypothesis testing}
\label{sec-3}

\begin{itemize}
\item we construct confidence intervals by inverting tests (Casella and
      Berger section 9.2)
\begin{itemize}
\item For each $\theta_0$, let $A(\theta_0)$ be the acceptance region
        of a level $\alpha$ test of $H_0: \theta = \theta_0$.  For each
        sample $x$, define a set $C(x)$ in the parameter space
        by \[C(x) = \{\theta_0: x \in A(\theta_0)\}\].  Then the random
        set $C(X)$ is a $1-\alpha$ confidence set.
\item prove this result for hw
\end{itemize}
\item plot interval generated by the indicator functions: 1 if test
      rejects, zero otherwise. (on computer?)
\item using this result
\begin{itemize}
\item suppose $X_1,\dots,X_n \sim N(\mu,\sigma^2)$ and we want to
        construct a two-sided $1-\alpha$ confidence interval for $\mu$.
\begin{itemize}
\item $\sigma^2$ is known
\end{itemize}
\item start by getting the family of tests:
\begin{itemize}
\item test of $H_0: \mu = \mu_0$ vs $\mu \neq \mu_0$ is given by:
\begin{description}
\item[reject] if $\mu_0 > \bar X + z_{\alpha/2}
                      \sigma / \sqrt{n}$ or $\mu_0 < \bar X - 
                      z_{\alpha/2} \sigma / \sqrt{n}$.
\item[accept] otherwise
\end{description}
\item gives $A(\mu_0) = \{x :\bar X - z_{\alpha/2} \sigma /
          \sqrt{n} \leq \mu_0 \leq \bar X + z_{\alpha/2} \sigma /
          \sqrt{n}\}$
\item then $C(x) = \{\mu :\bar X - z_{\alpha/2}  \sigma /
          \sqrt{n} \leq \mu \leq \bar X + z_{\alpha/2} \sigma /
          \sqrt{n}\}$
\begin{itemize}
\item we're changing two things
\begin{description}
\item[→] the set $A(\mu_0)$ has samples as its elements
\item[→] the set $C(x)$ has parameter values as its elements
\item[→] $A(\mu_0)$ is different for different parameter values
\item[→] $C(x)$ is different for different samples
\end{description}
\end{itemize}
\end{itemize}
\end{itemize}
\end{itemize}
\section{Pivoting the CDF}
\label{sec-4}

\begin{itemize}
\item works for one parameter, continuous rv.
\item suppose you have a statistic $\hat\theta$ and know that its distribution
      function, $F(t; \theta)$, is a monotone function of $\theta$
\begin{itemize}
\item e.g. if $\hat\theta$ is normal with mean $\theta$ and variance one, then
        $F(t; \theta) = \Phi(t - \theta)$ which is decreasing in
        $\theta$.
\end{itemize}
\item we can define a $1-\alpha$ confidence interval of the form
      $[\theta_L(\hat\theta), \theta_U(\hat\theta)]$ by solving the
      following equations for $\theta_L, \theta_U$
\begin{description}
\item[decreasing in $\theta$] \[F(\hat\theta; \theta_U) = \alpha/2\]
           and \[F(\hat\theta; \theta_L) = 1 - \alpha/2\]
\item[increasing in $\theta$] \[F(\hat\theta; \theta_L) = \alpha/2\]
           and \[F(\hat\theta; \theta_U) = 1 - \alpha/2\]
\end{description}
note that the L and U are switched in the two formulae.
\item You can also do this with asymptotic distributions (and that's the
     usual approach in economics for presenting asymptotic CI
\item example: Let $X_1,\dots,X_n$ be iid $N(\theta, 1)$ and we want to
     construct a two-sided 95\% interval for $\theta$.
\begin{itemize}
\item know that $\sqrt{n} (\bar X - \theta) \to N(0,1)$ in distribution.
\item define $\hat\theta = \sqrt{n} \bar X$
\begin{itemize}
\item $F(t; \theta) = \Phi(t - \theta \sqrt{n})$
\item obviously, decreasing in $\theta$, so solve
\begin{itemize}
\item $\Phi(\sqrt{n} \bar X - \theta_U \sqrt{n}) = 0.025$
\item $\Phi(\sqrt{n} \bar X - \theta_L \sqrt{n}) = 0.975$
\end{itemize}
\item this becomes:
\begin{itemize}
\item $\sqrt{n} \bar X - \theta_U \sqrt{n} = \Phi^{-1}(0.025)$
\item $\sqrt{n} \bar X - \theta_L \sqrt{n} = \Phi^{-1}(0.975)$
\end{itemize}
\item which in turn becomes:
\begin{itemize}
\item $\theta_U = \bar X - \Phi^{-1}(0.025) / \sqrt{n} = \bar X +
           1.96/\sqrt{n}$
\item $\theta_L = \bar X - \Phi^{-1}(0.975) / \sqrt{n} = \bar X -
           1.96/\sqrt{n}$
\end{itemize}
\item which is the standard confidence interval.
\end{itemize}
\end{itemize}
\end{itemize}